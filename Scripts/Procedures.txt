DELIMITER //
CREATE PROCEDURE SCH_KIOSCO.SP_STOCK_ACTUAL (IN CODBAR VARCHAR(255)) 
BEGIN 
	IF CODBAR <> '' THEN 
		SELECT S.PRODUCT_ID,PR.NOMBRE,S.STOCK_MINIMO,S.STOCK_ACTUAL,P.VALOR_COSTO,P.VALOR_VENTA,S.FECHA_REPO,S.USUARIO_ID
		FROM SCH_KIOSCO.stock AS S INNER JOIN  SCH_KIOSCO.product AS PR ON S.PRODUCT_ID = PR.PRODUCT_ID
		INNER JOIN SCH_KIOSCO.price AS P ON PR.PRODUCT_ID = P.PRODUCT_ID
		WHERE P.VALOR_COSTO <> 0 AND P.VALOR_VENTA <> 0 AND PR.CODIGO_BARRAS = CODBAR
        ORDER BY S.PRODUCT_ID;
	ELSE 
		SELECT S.PRODUCT_ID,PR.NOMBRE,S.STOCK_MINIMO,S.STOCK_ACTUAL,P.VALOR_COSTO,P.VALOR_VENTA,S.FECHA_REPO,S.USUARIO_ID
		FROM SCH_KIOSCO.stock AS S INNER JOIN  SCH_KIOSCO.product AS PR ON S.PRODUCT_ID = PR.PRODUCT_ID
		INNER JOIN SCH_KIOSCO.price AS P ON PR.PRODUCT_ID = P.PRODUCT_ID
		WHERE P.VALOR_COSTO <> 0 AND P.VALOR_VENTA <> 0
        ORDER BY S.PRODUCT_ID;
	END IF;
END //
DELIMITER ;